webpackJsonp([1],{127:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=e(337),a=(e.n(i),e(338));e.n(a);new(e(130).a)(".table-container",{hasBorder:!0})},129:function(n,t,e){"use strict";function i(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}var a=e(124),o=e.n(a),l=function(){function n(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),r=function(){function n(t){i(this,n),this.$td=o()(t),this.$drag=this.$td.find(".drag"),this.isResizing=!1,this.addEventListener()}return l(n,[{key:"addEventListener",value:function(){var n=this;this.$drag.on("mousedown",function(t){n.isResizing=!0,t.preventDefault()}),o()(document).on("mousemove",function(t){if(n.isResizing){var e=n.$td.data("col"),i=n.$td.data("row"),a=n.$td.parents("table");n.$drag.hasClass("drag-bottom")?a.find(".row-"+i).css({height:t.pageY-n.$td.offset().top}):a.find(".col-"+e).find("input").css({width:Math.max(t.pageX-n.$td.offset().left,60)})}}).on("mouseup",function(){n.isResizing=!1})}}]),n}();t.a=r},130:function(n,t,e){"use strict";function i(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}var a=e(124),o=e.n(a),l=e(129),r=function(){function n(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),s=function(){function n(t,e){i(this,n),this.hasBorder=e.hasBorder||!1,this.mousedown=!1,this.width=5,this.height=15,this.$container=o()(t),this.$table=this.createTable(),this.$container.append(this.$table),this.$menu=this.createMenu(),this.$container.append(this.$menu),this.menuStuffInit(),this.tdEventListener()}return r(n,[{key:"createTable",value:function(){var n=o()('<table cellspacing="0"></table>');n.append(this.createThead()),this.$tbody=o()("<tbody></tbody>");for(var t=1;t<=this.height;t++){for(var e=o()("<tr></tr>"),i=0;i<=this.width;i++){var a="";0===i&&(a=t),e.append(this.createTd(a,t,i,0===i))}this.$tbody.append(e)}return n.append(this.$tbody),this.hasBorder&&n.addClass("border"),n}},{key:"createThead",value:function(){for(var n=o()("<thead></thead>"),t=o()("<tr></tr>"),e=0;e<=this.width;e++){var i="";e>0&&(i=String.fromCharCode(64+e)),t.append(this.createTd(i,0,e,!0,!0))}return n.append(t).append(t.clone()),n}},{key:"createTd",value:function(n,t,e,i,a){var r=o()('\n            <td>\n                <input\n                    value="'+n+'"\n                    disabled\n                />\n            </td>\n        ').data("row",t).data("col",e).addClass("row-"+t).addClass("col-"+e);return i&&r.addClass("header-td"),0===e&&(r.append('\n                <div class="drag drag-bottom"></div>\n            '),new l.a(r)),a&&0!==e&&(r.append('\n                <div class="drag drag-right"></div>\n            '),new l.a(r)),r}},{key:"selectTd",value:function(){var n=this.$startNode.data("row"),t=this.$startNode.data("col"),e=this.$endNode.data("row"),i=this.$endNode.data("col"),a=Math.min(n,e),o=Math.max(n,e),l=Math.min(t,i),r=Math.max(t,i);this.$tbody.find("td").removeClass("selected");for(var s=a;s<=o;s++)for(var d=l;d<=r;d++)this.$tbody.find("td.row-"+s+".col-"+d).addClass("selected")}},{key:"createMenu",value:function(){return o()('\n            <ul class="menu-list">\n                <li class="allInOne">合并单元格</li>\n                <li class="font">设置字体\n                    <ul class="font-setting">\n                        <li class="fontBlack">加粗 / 正常</li>\n                        <li class="fontItalic">斜体 / 正常</li>\n                        <li class="fontUnderline">下划线 / 正常</li>\n                        <li class="fontAlign">文字对齐\n                            <ul class="font-sub-setting">\n                                <li class="textLeft">\n                                    左对齐\n                                </li>\n                                <li class="textCenter">\n                                    居中\n                                </li>\n                                <li class="textRight">\n                                    右对齐\n                                </li>\n                            </ul>\n                        </li>\n                    </ul>\n                </li>\n                <li class="changeContent">\n                    修改文字\n                </li>\n            </ul>\n        ')}},{key:"menuStuffInit",value:function(){this.$btnFontBlack=this.$menu.find(".fontBlack"),this.$btnFontItalic=this.$menu.find(".fontItalic"),this.$btnFontUnderline=this.$menu.find(".fontUnderline"),this.$btnTextLeft=this.$menu.find(".textLeft"),this.$btnTextCenter=this.$menu.find(".textCenter"),this.$btnTextRight=this.$menu.find(".textRight"),this.$btnChangeContent=this.$menu.find(".changeContent"),this.$btnAllInOne=this.$menu.find(".allInOne")}},{key:"fontHandler",value:function(n){var t=this.$table.find(".selected");if(-1!==n.search("text"))t.removeClass("text-left").removeClass("text-center").removeClass("text-right").addClass(n);else{t[t.hasClass(n)?"removeClass":"addClass"](n)}}},{key:"clearInputStatus",value:function(n){n.each(function(n,t){var e=o()(t);e.hasClass("selected")||e.find("input").attr("disabled",!0)})}},{key:"enableInput",value:function(){this.$table.find(".selected").find("input").attr("disabled",!1)}},{key:"tdEventListener",value:function(){var n=this,t=this.$tbody.find("td");t.on("mousedown",function(t){var e=o()(t.currentTarget);e.hasClass("header-td")||0===t.button&&(n.mousedown=!0,n.$startNode=e,n.endInput=t.target)}).on("dblclick",function(){n.enableInput()}),t.contextmenu(function(t){return n.$menu.offset({top:t.pageY,left:t.pageX}).addClass("active"),!1}),o()(document).on("click",function(t){0===t.button&&n.$menu.offset({top:0,left:0}).removeClass("active")}).on("mousemove",function(t){if("INPUT"===t.target.nodeName&&n.mousedown){var e=t.target,i=o()(e).parent();i.hasClass("header-td")||(n.endInput=e,n.$endNode=i,n.selectTd())}}).on("mouseup",function(t){0===t.button&&"LI"!==t.target.nodeName&&(n.mousedown?(n.mousedown=!1,"INPUT"===t.target.nodeName&&(n.endInput=t.target),n.$endNode=o()(n.endInput).parent(),n.selectTd()):n.$tbody.find("td").removeClass("selected"))}),this.$btnFontBlack.on("click",function(){n.fontHandler("bold")}),this.$btnFontItalic.on("click",function(){n.fontHandler("italic")}),this.$btnFontUnderline.on("click",function(){n.fontHandler("underline")}),this.$btnTextLeft.on("click",function(){n.fontHandler("text-left")}),this.$btnTextCenter.on("click",function(){n.fontHandler("text-center")}),this.$btnTextRight.on("click",function(){n.fontHandler("text-right")}),this.$btnChangeContent.on("click",function(){n.enableInput()}),this.$btnAllInOne.on("click",function(t){var e=n.$tbody.find("td.selected"),i=new Set,a=new Set;e.each(function(n,t){var e=o()(t);i.add(e.data("row")),a.add(e.data("col"))}),e.each(function(n,t){0!==n&&o()(t).remove()}),e.eq(0).attr("colspan",a.size).attr("rowspan",i.size)})}}]),n}();t.a=s},334:function(n,t,e){t=n.exports=e(123)(void 0),t.push([n.i,"html, body, div, span, applet, object, iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, a,\nabbr, acronym, address, big, cite, code, del, dfn, em, img, ins, kbd, q, s, samp, small, strike, strong,\nsub, sup, tt, var, b, u, i, center, dl, dt, dd, ol, ul, li, fieldset, form, label, legend,\ntable, caption, tbody, tfoot, thead, tr, th, td, article, aside, canvas, details, embed, figure,\nfigcaption, footer, header, hgroup, menu, nav, output, ruby, section, summary, time, mark, audio, video {\n  text-decoration: none;\n  outline: none;\n  margin: 0;\n  padding: 0;\n  border: 0;\n  font-size: 0;\n  -webkit-tap-highlight-color: transparent;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  list-style: none; }\n\nhtml {\n  /* Prevent font scaling in landscape while allowing user zoom */\n  -webkit-text-size-adjust: 100%;\n  /* fix font family display error on different browsers */\n  -moz-osx-font-smoothing: grayscale;\n  -webkit-font-smoothing: antialiased;\n  text-rendering: optimizeLegibility; }\n\na {\n  text-decoration: none;\n  color: black; }\n\n.preload img, .preload canvas {\n  width: 100%;\n  height: auto;\n  display: block; }\n\nhtml,\nbody {\n  width: 100%;\n  height: 100%; }\n",""])},335:function(n,t,e){t=n.exports=e(123)(void 0),t.push([n.i,".table-container {\n  position: relative; }\n  .table-container table {\n    display: table;\n    border-collapse: collapse; }\n    .table-container table thead tr {\n      z-index: 1; }\n      .table-container table thead tr:nth-child(1) {\n        position: fixed;\n        top: 0;\n        left: 0;\n        z-index: 9999; }\n    .table-container table td {\n      position: relative;\n      display: table-cell;\n      font-size: 14px;\n      width: 120px;\n      min-width: 120px;\n      min-height: 20px;\n      height: 20px;\n      line-height: 20px;\n      cursor: pointer; }\n      .table-container table td input {\n        display: block;\n        width: calc(100% - 2px);\n        height: 100%;\n        background-color: inherit;\n        border-width: 0;\n        line-height: inherit;\n        cursor: pointer;\n        -webkit-user-select: none;\n           -moz-user-select: none;\n            -ms-user-select: none;\n                user-select: none; }\n        .table-container table td input:focus {\n          outline-width: 0; }\n        .table-container table td input:disabled {\n          color: inherit; }\n      .table-container table td .drag {\n        position: absolute;\n        opacity: 0;\n        -webkit-transition: opacity ease 0.3s;\n        -o-transition: opacity ease 0.3s;\n        transition: opacity ease 0.3s; }\n        .table-container table td .drag.drag-bottom {\n          left: 0;\n          bottom: 0;\n          width: 100%;\n          height: 2px;\n          background-color: black;\n          cursor: ns-resize; }\n        .table-container table td .drag.drag-right {\n          right: 0;\n          top: 0;\n          width: 2px;\n          height: 100%;\n          background-color: black;\n          cursor: ew-resize; }\n        .table-container table td .drag:hover {\n          opacity: 1; }\n      .table-container table td.col-0 {\n        min-width: 60px; }\n      .table-container table td.header-td {\n        background-color: #edf3f8; }\n      .table-container table td.selected {\n        background-color: #e6e6e6; }\n      .table-container table td.bold input {\n        font-weight: bold; }\n      .table-container table td.italic input {\n        font-style: italic; }\n      .table-container table td.underline input {\n        text-decoration: underline; }\n      .table-container table td.text-left input {\n        text-align: left; }\n      .table-container table td.text-center input {\n        text-align: center; }\n      .table-container table td.text-right input {\n        text-align: right; }\n    .table-container table.border td {\n      border: 1px solid black; }\n  .table-container .menu-list {\n    position: absolute;\n    display: none;\n    background-color: #FAFAFA;\n    border-radius: 5px;\n    -webkit-box-shadow: 0 6px 12px rgba(0, 0, 0, .175);\n            box-shadow: 0 6px 12px rgba(0, 0, 0, .175); }\n    .table-container .menu-list li {\n      position: relative;\n      font-size: 14px;\n      width: 140px;\n      display: block;\n      padding: 10px 0 10px 5px;\n      cursor: pointer;\n      border-radius: 5px;\n      border: 1px solid #ddd;\n      color: #555;\n      background-color: #fff; }\n      .table-container .menu-list li:hover {\n        background-color: #f5f5f5; }\n      .table-container .menu-list li.font .font-setting,\n      .table-container .menu-list li.font .font-sub-setting {\n        position: absolute;\n        left: 100%;\n        top: 0px;\n        display: none; }\n      .table-container .menu-list li.font:hover .font-setting {\n        display: block; }\n      .table-container .menu-list li.font .fontAlign:hover .font-sub-setting {\n        display: block; }\n    .table-container .menu-list.active {\n      display: block; }\n",""])},337:function(n,t,e){var i=e(334);"string"==typeof i&&(i=[[n.i,i,""]]);var a={};a.transform=void 0;e(125)(i,a);i.locals&&(n.exports=i.locals)},338:function(n,t,e){var i=e(335);"string"==typeof i&&(i=[[n.i,i,""]]);var a={};a.transform=void 0;e(125)(i,a);i.locals&&(n.exports=i.locals)},340:function(n,t,e){e(128),n.exports=e(127)}},[340]);